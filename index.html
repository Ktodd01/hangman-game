<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Invaders</title>
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: black;
            color: white;
            overflow: hidden;
        }
        #gameCanvas {
            background: black;
            border: 1px solid white;
        }
        #gameInfo {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div id="gameInfo">
        <p>Use arrow keys to move and spacebar to shoot</p>
        <p>Score: <span id="score">0</span></p>
    </div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        let ship = {
            x: canvas.width / 2 - 15,
            y: canvas.height - 30,
            width: 30,
            height: 30,
            dx: 5,
            bullets: []
        };

        let invaders = [];
        const rows = 5;
        const cols = 8;
        const invaderWidth = 30;
        const invaderHeight = 30;
        const invaderGap = 10;
        const invaderXStart = (canvas.width - (cols * (invaderWidth + invaderGap))) / 2;
        const invaderYStart = 30;
        const invaderSpeed = 1;
        const invaderDrop = 20;

        let score = 0;

        function createInvaders() {
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    invaders.push({
                        x: invaderXStart + col * (invaderWidth + invaderGap),
                        y: invaderYStart + row * (invaderHeight + invaderGap),
                        width: invaderWidth,
                        height: invaderHeight,
                        dx: invaderSpeed
                    });
                }
            }
        }

        function drawShip() {
            ctx.fillStyle = 'white';
            ctx.fillRect(ship.x, ship.y, ship.width, ship.height);
        }

        function drawInvaders() {
            invaders.forEach(invader => {
                ctx.fillStyle = 'red';
                ctx.fillRect(invader.x, invader.y, invader.width, invader.height);
            });
        }

        function drawBullets() {
            ship.bullets.forEach(bullet => {
                ctx.fillStyle = 'yellow';
                ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
            });
        }

        function moveShip() {
            if (leftPressed && ship.x > 0) {
                ship.x -= ship.dx;
            }
            if (rightPressed && ship.x < canvas.width - ship.width) {
                ship.x += ship.dx;
            }
        }

        function moveBullets() {
            ship.bullets.forEach(bullet => {
                bullet.y -= bullet.dy;
            });
            ship.bullets = ship.bullets.filter(bullet => bullet.y > 0);
        }

        function moveInvaders() {
            invaders.forEach(invader => {
                invader.x += invader.dx;
            });

            const rightMostInvader = invaders.reduce((max, invader) => (invader.x > max ? invader.x : max), 0);
            const leftMostInvader = invaders.reduce((min, invader) => (invader.x < min ? invader.x : min), canvas.width);

            if (rightMostInvader + invaderWidth >= canvas.width || leftMostInvader <= 0) {
                invaders.forEach(invader => {
                    invader.dx *= -1;
                    invader.y += invaderDrop;
                });
            }
        }

        function detectCollisions() {
            ship.bullets.forEach(bullet => {
                invaders.forEach((invader, invaderIndex) => {
                    if (
                        bullet.x < invader.x + invader.width &&
                        bullet.x + bullet.width > invader.x &&
                        bullet.y < invader.y + invader.height &&
                        bullet.y + bullet.height > invader.y
                    ) {
                        invaders.splice(invaderIndex, 1);
                        bullet.y = -10; // Move bullet offscreen
                        score += 10;
                        document.getElementById('score').textContent = score;
                    }
                });
            });
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawShip();
            drawInvaders();
            drawBullets();
        }

        function update() {
            moveShip();
            moveBullets();
            moveInvaders();
            detectCollisions();
            draw();
            requestAnimationFrame(update);
        }

        createInvaders();
        update();

        let leftPressed = false;
        let rightPressed = false;

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                leftPressed = true;
            }
            if (e.key === 'ArrowRight') {
                rightPressed = true;
            }
            if (e.key === ' ') {
                ship.bullets.push({
                    x: ship.x + ship.width / 2 - 2.5,
                    y: ship.y,
                    width: 5,
                    height: 10,
                    dy: 5
                });
            }
        });

        document.addEventListener('keyup', (e) => {
            if (e.key === 'ArrowLeft') {
                leftPressed = false;
            }
            if (e.key === 'ArrowRight') {
                rightPressed = false;
            }
        });
    </script>
</body>
</html>
